# Руководство по DoubleContact #

??? форматирование: выделение жирным пунктов меню и кнопок

## О проекте ##

DoubleContact - это автономный и независимый от DE редактор контактов, преимущественно ориентированный на
редактирование, сравнение и слияние телефонных книг.
Интерфейс программы аналогичен интерфейсу двухпанельных файловых менеджеров, но вторую панель можно отключить.


Основные возможности:
* загрузка адресных книг форматов VCF и UDX (поддерживаются vCard 2.1 и 3.0, а также возможность загрузки каталога,
содержащего множество файлов VCF, как единой адресной книги) и сохранение в указанных форматах;
* импорт контактов из файла MPB (резервная копия MyPhoneExplorer);
* просмотр контактов в табличном виде, с фильтрацией и сортировкой;
* двухпанельный режим просмотра двух адресных книг, с возможностью копирования и перемещения групп контактов;
* редактирование отдельных записей;
* групповые операции над выбранными записями: перестановка имени и фамилии, разделение имён,
перевод телефонных номеров в международный формат (замена 8 на +7 для России, ??? УКР.),
разделение контакта по телефонам для экспорта на SIM-карту, слияние контактов,
удаление спецсимволов, генерация форматированного (полного) имени;
* сравнение двух адресных книг с подсветкой совпадающих, несовпадающих и частично совпадающих контактов;
* интерактивное слияние контактов по результатам сравнения.


## Загрузка и импорт контактов ##

Для загрузки контактов прежде всего необходимо подготовить файл (файлы) адресной книги.

Например, телефоны с ОС Android позволяют выгрузить адресную книгу в один файл формата VCF
(Контакты -> Импорт/Экспорт -> Экспортировать контакты -> SD карта в меню телефона).
В зависимости от версии и комплектации Андроида названия пунктов меню могут незначительно отличаться от приведённых.
Полученный файл переписывается с карты памяти на ПК.

Аналогичный файл можно получить на кнопочных телефонах Sony Ericsson  некоторых других производителей.
Особняком стоят телефоны Philips Xenium: они сохраняют адресную книгу не в VCF, а в собственном формате UDX,
который DoubleContact  тоже умеет открывать.

??? меню телефона и хитрость с открытием нескольких

Некоторые телефоны и программы (например, некоторые версии Nokia PC Suite) сохраняют каждый контакт в отдельном файле VCF.
В этом случае на ПК следует перенести весь каталог (папку) с файлами VCF.

Если адресная книга была сохранена в одном файле, в программе выбираем пункт меню Файл -> Открыть -> Файл и открываем нужный файл,
который имеет расширение VCF, UDX или MPB. Если же адресная книга представляет собой каталог файлов VCF, выбираем пункт меню
Файл -> Открыть -> Каталог.

В обоих случаях DoubleContact загружает адресную книгу и отображает её в виде таблицы.

Таким же образом можно загрузить контакты из файла резервной копии программы MyPhoneExplorer (расширение MPB). Обратите внимание, что
из этого типа файлов контакты можно только читать, запись не поддерживается.

Если при загрузке возникли проблемы (как правило, неизвестные теги), программа покажет окно протокола с перечнем проблем. Не стоит
беспокоиться: неизвестные теги бережно сохраняются при просмотре и редактировании и записываются при сохранении адресной книги в файл.
Более того, Вы можете просмотреть их содержимое на вкладке "Проблемы" окна редактирования контакта. Контакты с неизвестными тегами
при просмотре выделяются жёлтым цветом. Однако Вы очень поможете автору в развитии программы, если пошлёте ему примеры таких тегов.


## Сохранение контактов ##

Перед сохранением необходимо определить, для какого устройства или программы предназначен сохраняемый файл. Большинство современных телефонов
понимают формат vCard версий 3.0 или 4.0. Однако для некоторых, особенно старых, устройств требуется vCard 2.1. Задать версию vCard можно в окне настроек
(пункт меню Вид -> Настройки, вкладка Сохранение). Если отметить флажок "Брать версию из исходного файла (если есть)", программа будет пытаться
использовать версию vCard, применявшуюся в файле, из которого была загружена адресная книга. В противном случае всегда будет использоваться версия,
выбранная в окне настроек.

В некоторых случаях, например, если vcf-файл будет загружаться в SIM-карту телефона, необходимо, чтобы каждому контакту соответствовало не более
одного телефонного номера. В этом случае перед сохранением адресной книги следует произвести разделение контактов: выделить разделяемые контакты
(как правило, проще всего выделить все) и выбрать пункт меню Контакт -> Разделить.

Для сохранения адресной книги в единый файл в программе выбираем пункт меню Файл -> Сохранить как -> Файл, выбираем его тип (VCF или UDX) и вводим
имя файла. Для сохранения адресной книги в виде каталога файлов VCF, выбираем пункт меню Файл -> Сохранить как -> Каталог. Полученный файл
(каталог) можно скопировать на устройство и импортировать его.


## Просмотр контактов ##

Загруженные контакты отображаются программой в виде таблицы. Каждая строка таблицы - это один контакт.

Состав и порядок столбцов таблицы можно настраивать (пункт меню Вид -> Настройки,
вкладка "Столбцы"). Просто переместите кнопками-стрелками нужные столбцы из списка "Доступные" в список "Видимые".
Названия большинства столбцов очевидны ("Имя", "Фамилия", "Описание" и т.д.), но есть исключения.

В поле "Телефон" отображается телефон, имеющий тип "Предпочтительный" либо указанный первым. Аналогично работает
поле "Электропочта". 

Некоторые типы столбцов являются индикаторами: они отображают символ \*, если выполняется некоторое условие.
Так, условие "Есть телефон" выполняется, если для контакта задан хотя бы один телефон, условие "Много телефонов" -
если телефонов больше одного. Аналогичные индикаторы предусмотрены для адресов электронной почты и дней рождения.

Столбец "Универсальное имя" (Generic name) предназначен для того, чтобы информация выводилась даже для плохо заполненных
контактов. Если полное (форматированное) имя существует, в этом столбце выводится оно. Если нет, программа
пытается сконструировать его из имён. Если не заданы имена, программа пытается использовать название
организание, описание, телефон или адрес электронной почты, наконец, строку сортировки.

Сортировка контактов включается и выключается клавишей F4. Порядок сортировки задаётся щелчками мыши
по заголовку нужного столбца.

По умолчанию программа показывает все записи в книги, однако их можно фильтровать. По нажатию Ctrl+F
под таблицей появляется поле ввода. Если ввести туда имя или его часть, в таблице будут видны только
те контакты, в которых есть эта часть. Например, если ввести "Вла", программа покажет контакты
"Владимир Иванович", "Александр Власов". Если ввести "324" - контакт с телефоном +79993246543. После
очистки поля вновь будут видны все контакты.

Пункт меню Вид -> Две панели отобразит две панели, в каждую из которых можно загрузить отдельную
адресную книгу. Переключение между панелями производится щелчком мышью или клавишей Tab. Поменять
панели местами можно клавишей Ctrl+U.

Чтобы скопировать одну или несколько записей из одной загруженной адресной книги в другую, выделите
эти записи и нажмите F5. Чтобы переместить - выделите и нажмите F6 (в последнем случае в исходной
книге контакты будут удалить).

Повторный вызов Вид -> Две панели отключает двухпанельный режим.

Над каждой адресной книгой отображается имя файла (каталога), из которого она загружена. Если в книгу
внесены несохранённые изменения, это имя сопровождается знаком (\*).


## Редактирование контактов ##

Основной режим редактирования в DoubleContact - это редактирование одной записи. Групповое редактирование
тоже предусмотрено, но в этом режиме можно менять только некоторые поля.
Окна редактирования при этом вызываются разные.

Для редактирования одного контакта выберите его в таблице и нажмите кнопку "Править". Также можно нажать Enter
или дважды щёлкнуть по контакту мышью. Откроется окно "Правка контакта".

На вкладке "Общее" количество полей зависит от контакта: количество имён - от 2 до 5,
минимальное количество телефонов и адресов электронной почты - по 1 (максимальное количество не ограничено).
Общепринятый порядок имён: фамилия, имя, отчество (либо среднее имя, MiddleName), обращение, степень/звание.
Однако все эти поля не обязательны.

Номера телефонов и адреса электронной почты вводятся в произвольном текстовом формате. Однако если эти
поля содержат недопустимые символы, возможно, Ваше устройство не сможет их распознать.

Чтобы добавить ещё одно имя, телефон или адрес электронной почты, выберите в списке рядом с кнопкой
"Добавить...", что именно Вы хотите добавить, и нажмите "Добавить...". Чтобы убрать одно из этих полей,
нажмите кнопку с красным крестиком рядом с полем.

Вводя телефон, не забудьте выбрать из списка его тип: домашний, рабочий, мобильный и др. Вы можете захотеть
комбинировать эти типы (как правило, один из этих типов комбинируется с типом "Предпочтительный").
В этом случае выберите тип "составной..." Программа откроет окно "Тип телефона", в котором нужная
комбинация типов набирается флажками.

Контакт может содержать день рождения. Как правило, для дня рождения задаётся только дата: поставьте
галочку, задайте день, месяц и год. Но по стандарту vCard можно задать и время. Для этого нажмите
кнопку "Подробно". Появится окно "Свойства даты", где кроме даты, можно указать и время, и даже
часовой пояс, по которому оно задано.

Кроме дня рождения, в контакте можно указать и другую годовщину (обычно это годовщина свадьбы).
Выберите в списке рядом с кнопкой "Добавить..." пункт "годовщину" и нажмите "Добавить...".
Годовщина редактируется так же, как и день рождения.

На вкладке "Адреса" можно ввести до двух адресов (домашний и рабочий). Если домашний и рабочий
адреса перепутаны, или просто один адрес введён не в своей панели, Вы можете исправить это,
нажав кнопку "<>". На этой же вкладке можно указать должность и название "Организация".

На вкладке "Интернет" можно ввести сетевой псевдоним (ник) человека, адрес сайта и адреса в различных
IM. Это самая простая вкладка.

На вкладке "Прочее" приводятся технические подробности о формате контакта. Эта информация может потребоваться
для сообщения об ошибке автору программы. Здесь же в табличном виде можно просмотреть теги vCard, о
которых программа знает, но редактировать не позволяет. Здесь же можно задать строку, по которой
контакт будет сортироваться с себе подобными.

Наконец, на вкладке "Проблемы" содержатся неизвестные теги (атрибуты) контакта. Как уже отмечалось,
они сохраняются при просмотре и редактировании и записываются при сохранении адресной книги в файл.
Автор будет признателен, если Вы пришлёте ему примеры таких тегов.

По окончании редактирования нажмите "ОК" для сохранения сделанный правок или "Отмена" для их отмены.

Редактирование нескольких выбранных записей вызывается аналогично. Однако при этом редактировать
можно только некоторые поля: должность, организация, описание.

Наконец, чтобы добавить новый контакт в текущую адресную книгу, нажмите в главном окне кнопку
"Вставить" или клавишу Ins. При этом откроется окно, аналогичное окну редактирования одной записи.


## Групповые операции над контактами ##

Зачастую в адресной книге (особенно, если она ведётся много лет) имена и фамилии разных контактов
записаны в разном порядке. Чтобы исправить это, выберите все контакты, у которых фамилия и имя
перепутаны (например, фамилия Александр, имя Иванов), и вызовите пункт меню Контакт -> Переставить имена.
Программа поменяет местами имя и фамилию у всех выбранных контактов.

Следующая операция - разделение имён - нужна, когда имя, фамилия и другие части имени были записаны в адресной
книге как единое целое через пробелы. Обычно так получается, если адресная книга импортирована с
SIM-карты старого телефона. Выберите такие записи и вызовите пункт меню Контакт -> Разделить имена
(Shift+F2). Программа разделит имя по пробелам. Для некоторых контактов после этого, возможно, придётся
провести перестановку имён, описанную выше, если имена изначально были записаны в неправильном порядке.

Вы можете захотеть склеить две записи в один контакт. Как правило, это два телефона одного человека,
или телефон и электронная почта и т.д. Выберите строго два контакта на текущей панели и вызовите
пункт меню Контакт -> Склеить. При этом откроется окно "Слияние контактов". В нём подсвечиваются
общие и отличающиеся части контакта. Используя кнопки со стрелками, можно копировать данные из
одного контакта (имена, телефоны, адреса электронной почты и др.) в другой. По окончании редактирования
в таблице останутся оба контакта. Наиболее полный можно оставить, а второй удалить вручную.

Если Вы перед склейкой выбрали больше или меньше, чем 2 контакта, программа выдаст сообщение об ошибке.

Обратная операция - разделение контактов по телефонам - нужна, если адресная книга будет загружаться в
SIM-карту телефона, и необходимо, чтобы каждому контакту соответствовало не более одного телефонного номера.
Выделите разделяемые контакты (как правило, проще всего выделить все) и выберите пункт меню
Контакт -> Разделить.

Ещё одна групповая операция - автоматическое формирование полного (форматированного) имени по введённым именам.

Иногда, если файл VCF импортирован с SIM-карты, в именах контактов встречаются спецсимволы -
обратная косая черта, зачастую сопровождаемая цифрой. Пункт меню Контакт -> ??? позволяет удалить это безобразие.

Последняя групповая операция над контактами - это перевод телефонных номеров из национального формата в международный
для некоторых стран. Для России эта операция заменяет префикс 8 на код страны +7. Для ???

Чтобы перевести телефонные номера в международный формат, выберите группу номеров и вызовите Контакт -> 8 -> +7.
Программа предложит выбрать страну???

ВНИМАНИЕ! Автоматический выбор страны невозможен, поскольку? ?? неоднозначность 0, и попытка перевести в международный формат
сразу все контакты может привести к порче телефонных номеров. Поэтому если сначала У, потом Б или наоборот.
Особо тяжёлый случай - когда У и Б в одном контакте ??? только вручную


## Сравнение адресных книг ##

В двухпанельном режиме, если загружены две адресные книги, программа позволяет сравнить их в полуавтоматическом режиме.

Для сравнения двух адресных книг вызовите ??? Список -> Сравнить. Программа выполнит поиск пар контактов в обеих книгах.
По окончании поиска все контакты будут подсвечены:

* несовпадающие контакты будут выделены красным цветом. Это контакты, для которых программа не нашла пары;
* частично совпадающие контакты будут выделены жёлтым цветом;
* полностью совпадающие контакты будут выделены жёлтым цветом.

Контакты считаются полностью совпадающими, если 

выделение пары
отмена режима повторно
пример применения

## Маленькие хитрости ##

Ключи командной строки:

* --debugdata или -d - запуск программы с отладочным набором данных (несколько контактов на разных языках);
* --fullscreen или -f - запуск программы в полноэкранном режиме (кроме OS X);
* --quiet или -q - при запуске не загружаются никакие адресные книги, даже если в настройках задан режим "Открывать последние файлы при запуске".

Здесь же, вероятно, написать, что, если к телефону привязаны SMS и история переговоров.
